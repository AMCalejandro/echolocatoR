<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fine-map using multiple fine-mapping tools — multi_finemap • echolocatoR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fine-map using multiple fine-mapping tools — multi_finemap" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">echolocatoR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/QTL_pipeline_vignette.html">echolocatoR: QTL pipeline vignette</a>
    </li>
    <li>
      <a href="../articles/full_pipeline_vignette.html">echolocatoR: full pipeline vignette</a>
    </li>
    <li>
      <a href="../articles/plotting_vignette.html">echolocatoR: plotting vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RajLabMSSM/echolocatoR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fine-map using multiple fine-mapping tools</h1>
    <small class="dont-index">Source: <a href='https://github.com/RajLabMSSM/echolocatoR/blob/master/R/multi_finemap.R'><code>R/multi_finemap.R</code></a></small>
    <div class="hidden name"><code>multi_finemap.Rd</code></div>
    </div>

    <div class="ref-description">
    </div>

    <pre class="usage"><span class='fu'>multi_finemap</span>(
  <span class='no'>locus_dir</span>,
  <span class='no'>fullSS_path</span>,
  <span class='no'>finemap_method_list</span>,
  <span class='no'>subset_DT</span>,
  <span class='no'>dataset_type</span>,
  <span class='kw'>LD_matrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>n_causal</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>sample_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>snp_col</span> <span class='kw'>=</span> <span class='st'>"SNP"</span>,
  <span class='kw'>freq_col</span> <span class='kw'>=</span> <span class='st'>"Freq"</span>,
  <span class='kw'>effect_col</span> <span class='kw'>=</span> <span class='st'>"Effect"</span>,
  <span class='kw'>stderr_col</span> <span class='kw'>=</span> <span class='st'>"StdErr"</span>,
  <span class='kw'>pval_col</span> <span class='kw'>=</span> <span class='st'>"P"</span>,
  <span class='kw'>N_cases_col</span> <span class='kw'>=</span> <span class='st'>"N_cases"</span>,
  <span class='kw'>N_controls_col</span> <span class='kw'>=</span> <span class='st'>"N_controls"</span>,
  <span class='kw'>A1_col</span> <span class='kw'>=</span> <span class='st'>"A1"</span>,
  <span class='kw'>A2_col</span> <span class='kw'>=</span> <span class='st'>"A2"</span>,
  <span class='kw'>PAINTOR_QTL_datasets</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>PP_threshold</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='kw'>conda_env</span> <span class='kw'>=</span> <span class='st'>"echoR"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fullSS_path</th>
      <td><p>Path to the full summary statistics file (GWAS or QTL) that you want to fine-map.</p></td>
    </tr>
    <tr>
      <th>dataset_type</th>
      <td><p>The kind dataset you're fine-mapping (e.g. GWAS, eQTL, tQTL).
This will also be used when creating the subdirectory where your results will be stored
(e.g. <em>Data/&lt;dataset_type&gt;/Kunkle_2019</em>).</p></td>
    </tr>
    <tr>
      <th>n_causal</th>
      <td><p>The maximum number of potential causal SNPs per locus.
This parameter is used somewhat differntly by different fine-mapping tools.
See tool-specific functions for details.</p></td>
    </tr>
    <tr>
      <th>sample_size</th>
      <td><p>The overall sample size of the study.
If none is given, and <strong>N_cases</strong> and <strong>N_controls</strong> columns are present,
then sample_size is inferred to be:  <code>max(N_cases) + max(N_controls)</code>.</p></td>
    </tr>
    <tr>
      <th>snp_col</th>
      <td><p>Name of the SNP RSID column in the full summary stats file.
(<em>default: ="SNP"</em>)</p></td>
    </tr>
    <tr>
      <th>freq_col</th>
      <td><p>Name of the allele frequency column in the full summary stats file.
Effect allele frequency is preferred, but the non-effect allele can be provided instead (though this may be less accurate).
This column is not necessary unless <code>MAF_col="calculate"</code> or the MAF column is missing.
(<em>default: ="Freq"</em>)</p></td>
    </tr>
    <tr>
      <th>effect_col</th>
      <td><p>Name of the effect size column in the full summary stats file.
Effect size is preferred, but if not available other metrics like Beta for Odds Ratio can be used instead.
(<em>default: ="Effect"</em>)</p></td>
    </tr>
    <tr>
      <th>stderr_col</th>
      <td><p>Name of the standard error  column in the full summary stats file.
You can also set <code>stderr_col="calculate"</code> to infer standard error using: <code>effect / tstat</code>.
(<em>default: ="StdErr"</em>)</p></td>
    </tr>
    <tr>
      <th>pval_col</th>
      <td><p>Name of the p-value column in the full summary stats file.
Raw p-values are preferred, but if not available corrected p-values (e.g. FDR) can be used instead.
(<em>default: ="P"</em>)</p></td>
    </tr>
    <tr>
      <th>N_cases_col</th>
      <td><p>Name of the column in the full summary stats that has the number of case subjects in the study.
This can either be per SNP sample sizes, or one number repeated across all rows.
Proxy cases (e.g. relatives of people with the disease being investigated) should be included in this estimate if any were used in the study.
This column is not necesssary if <code>N_cases</code> parameter is provided.
(<em>default: ="N_cases"</em>)</p></td>
    </tr>
    <tr>
      <th>N_controls_col</th>
      <td><p>Name of the column in the full summary stats that has the number of control subjects in the study.
This can either be per SNP sample sizes, or one number repeated across all rows.
This column is not necesssary if <code>N_controls</code> parameter is provided.
(<em>default: ="N_controls"</em>)</p></td>
    </tr>
    <tr>
      <th>A1_col</th>
      <td><p>Name of the effect/risk allele column in the full summary stats.
<strong><em>IMPORTANT</em></strong>: Make sure this actually the case for your full summary stats file.
Unfortunately, different studies report different kinds of allele information in a non-standardized way.
Meaning that A1/A2 can refer to any number of things:</p><dl'>
<dt>effect/other alleles</dt><dd><p>in the case of diseases</p></dd>
<dt>ref/alt alleles</dt><dd><p>where ref is the reference genome being used</p></dd>
<dt>major/minor alleles</dt><dd><p>This dichotomy holds true for bi-allelic SNPs but not necessary multi-allelic SNPs</p></dd>

</dl><p>This makes comparing summary stats across GWAS/QTL datasets very confusing for several reasons:</p><dl'>
<dt>Multi-allelic SNPs</dt><dd><p>SNPs can have more than just 2 possible alleles (multi-allelic SNPs). Even if you compare the same SNP between two studies, you may accidentally be comparing totally different alleles.</p></dd>
<dt>Valence</dt><dd><p>The valence (+/-) of per-SNP GWAS effect sizes/beta can be relative to different allele types between studies.
For example, let's say in one GWAS study your effect size for SNP A is 1.5 relative to the major allele in one study,
and the minor allele happens to be the one found in the reference genome.
You then try to compare that effect size to that of the same SNP in another GWAS.
But, the valence of the effect sizes in the 2nd GWAS study are all relative to the reference genome (instead of the minor allele),
giving the same SNP a value of -1.2. If you took the effect sizes at face value you'd say the signals are in opposite directions.
But once you take into account how the valences were determined in each study you realize that they're actually both positive relative to the major allele.</p></dd>

</dl><p>This process of reversing per-SNP valences based on aligning the alleles is known as allele flipping.
This is important when comparing individual SNPs, but can also have an impact on colocalization results.</p></td>
    </tr>
    <tr>
      <th>PAINTOR_QTL_datasets</th>
      <td><p>A list of QTL datasets to be used when conducting joint functional fine-mapping with <em>PAINTOR</em>.</p></td>
    </tr>
    <tr>
      <th>PP_threshold</th>
      <td><p>The minimum fine-mapped posterior probability for a SNP to be considered part of a Credible Set.
For example, <code>PP_threshold=.95</code> means that all Credible Set SNPs will be 95\<!-- % Credible Set SNPs.} --></p>
<p>verboseWhether <em>echolocatoR</em> should be verbose or silent.</p>
<p>conda_envThe name of a conda environment to use.</p></td>
    </tr>
    </table>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Schilder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


